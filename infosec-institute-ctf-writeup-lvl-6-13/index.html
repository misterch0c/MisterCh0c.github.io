
<head>

    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <script>
        // UNCOMMENT AND USE YOUR VARIABLES FOR DISQUS AND GOOGLE ANALYTICS
        // var d_id  = '',
        g_id  = 'UA-43267317-1', 
        g_url = 'misterch0c.ghost.io' 

    </script>
    
    <title>Infosec Institute CTF writeup lvl 7 - 13</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/highlighter/prettify.css?v=3fb1664a48">
    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css?v=3fb1664a48">


    <link rel="canonical" href="index.html">
    
    <meta property="og:site_name" content="MisterCh0c">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Infosec Institute CTF writeup lvl 7 - 13">
    <meta property="og:description" content="Level 7   You have some kind of a login form. You want to make a prank on Twitter. You want to add a h1 to the page and share it with your Twitter followers so they can see that you...">
    <meta property="og:url" content="http://localhost:2368/infosec-institute-ctf-writeup-lvl-6-13/">
    <meta property="article:published_time" content="2015-07-04T13:37:52.468Z">
    <meta property="article:modified_time" content="2015-07-06T17:37:10.031Z">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Infosec Institute CTF writeup lvl 7 - 13">
    <meta name="twitter:description" content="Level 7   You have some kind of a login form. You want to make a prank on Twitter. You want to add a h1 to the page and share it with your Twitter followers so they can see that you...">
    <meta name="twitter:url" content="http://localhost:2368/infosec-institute-ctf-writeup-lvl-6-13/">
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "MisterCh0c",
    "author": {
        "@type": "Person",
        "name": "misterch0c",
        "url": "http://localhost:2368/author/misterch0c",
        "sameAs": null,
        "description": null
    },
    "headline": "Infosec Institute CTF writeup lvl 7 - 13",
    "url": "http://localhost:2368/infosec-institute-ctf-writeup-lvl-6-13/",
    "datePublished": "2015-07-04T13:37:52.468Z",
    "dateModified": "2015-07-06T17:37:10.031Z",
    "description": "Level 7   You have some kind of a login form. You want to make a prank on Twitter. You want to add a h1 to the page and share it with your Twitter followers so they can see that you..."
}
    </script>

    <meta name="generator" content="Ghost 0.6">
    <link rel="alternate" type="application/rss+xml" title="MisterCh0c" href="../rss/index.html">
    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    
      ga('create', g_id, g_url);
      ga('send', 'pageview');
    
    </script>
</head>
<body class="post-template">

    

<main class="content" role="main">

    <article class="post">

        <header class="post-header">
            <a id="blog-logo" href="../">
                    <img src="../content/images/2015/07/VSfNaIjh.jpeg" alt="Blog Logo">
            </a>
        </header>



        <h1 class="post-title">Infosec Institute CTF writeup lvl 7 - 13</h1>

        <section class="post-content">
            <p><br>  </p>

<h3 id="level7">Level 7</h3>

<blockquote>
  <p>You have some kind of a login form. You want to make a prank on Twitter. You want to add a h1 to the page and share it with your Twitter followers so they can see that you can modify the page as it pleases you. You do not really want to cause harm. 
  Do some magic and add <code>&lt;h1&gt;YOUR NAME HERE&lt;/h1&gt;</code> in a way that people who visit the link you provide will the heading.</p>
</blockquote>

<p>There was an hidden field on the page and it was pretty clear that this page was making request on it's own. So we have to exploit the <a href="http://www.cyberscorpion.com/2012-03/why-php_self-should-be-avoided-when-creating-website-links/">PHP_SELF vulnerability</a> here. This is how I injected the code closing the input tag: <br>
<code>http://ctf.infosecinstitute.com/ctf2/exercises/ex7.php?arg='&gt;&lt;h1&gt;username&lt;/h1&gt;
</code></p>

<h3 id="level8">Level 8</h3>

<blockquote>
  <p>Your task is to penetrate this site. You need to take advantage of the image upload and execute a JS script with an alert somehow through a file. Godspeed!</p>
</blockquote>

<p>The first thing I did was to upload a regular image file. Then I clicked on the "Editor's choice" and from there I knew were were stored the images: <br>
<code>http://ctf.infosecinstitute.com/ctf2/ex8_assets/img/chess3.png</code><br>
<code>http://ctf.infosecinstitute.com/ctf2/exercises/ex8.php?attachment_id=1</code><br>
Ok, so I tried to upload a html file but got an error. This was easy to bypass using burpsuite I just changed the extension from .jpg to .html and it worked (:</p>

<p><img src="../content/images/2015/07/2015-07-04--1436015617_594x260_scrot.png" alt=""></p>

<p><img src="../content/images/2015/07/2015-07-04--1436015735_447x60_scrot.png" alt=""></p>

<p>Unfortunately I couldn't access it like the other images. I got an error because the server is trying to load an image but our file isn't a valid images. So I thought maybe If I increased the id in attachment_id then my file should be referenced but nope... After some fuzzing I found out I was right about the referencing: <br>
<code>http://ctf.infosecinstitute.com/ctf2/exercises/ex8.php?file=payload8.jpg</code></p>

<h3 id="level9">Level 9</h3>

<p><img src="../content/images/2015/07/2015-07-04--1436016675_551x365_scrot.png" alt=""></p>

<p>First thing I did was to open Cookie Manager and check the cookie. I saw a string which looked like b64 in the content value and I was right. The decoded b64 looks like this: <code>JOHN+DOE</code>, alright.. So <code>MARY+JANE</code> in b64 is <code>TUFSWStKQU5F</code></p>

<p><img src="../content/images/2015/07/2015-07-04--1436017021_596x408_scrot.png" alt=""></p>

<p><img src="../content/images/2015/07/2015-07-04--1436017006_693x355_scrot.png" alt=""></p>

<h3 id="level10">Level 10</h3>

<p>A game... Ew I hate games, I didn't even wanted to play it to hack it, sorry  </p>

<h3 id="level11">Level 11</h3>

<blockquote>
  <p>It seems you have been blacklisted. Knowing what websites typically use to identify their users - try to get rid of that ban</p>
</blockquote>

<p>First thing I did was to connect to my vpn to see if I see any change but nope. So I check the cookie and <code>content</code> value was 'no" so I just said 'yes'</p>

<p><img src="../content/images/2015/07/2015-07-04--1436010593_591x239_scrot.png" alt=""></p>

<h3 id="level12">Level 12</h3>

<blockquote>
  <p>Your task is to crack the password of the user called admin. Use whatever tool you like but we would recommend entering Google and searching for filetype:lst password in order to perform a dictionary attack.</p>
</blockquote>

<p>Again I skipped this one because they pretty much give it away. They give the worlist and the attack... So just use your favorite http form bruteforer like wpfuzz, medusa, hydra, patator...  </p>

<h3 id="level13">Level 13</h3>

<blockquote>
  <p>Hmm, it seems that level thirteen is redirecting to this page. Why do not you analyze the redirect and search if the redirect is validated thoroughly. If not, you want to redirect to a page on a remote server and send links to people fooling them to think they are accessing a different domain.</p>
</blockquote>

<p>It took me a while to figure this on because I was jumping levels and ex13.php was a different page than the real challenge. But when I clicked on it and got the real page the solution was pretty obvious. It's just and insecure redirect:</p>

<p><code>http://ctf.infosecinstitute.com/ctf2/exercises/ex13.php?redirect=//google.com</code></p>

<p>Thx to byt3me who helped me in some of the challenges,you can checkout his writups which are more detailed than mine on <a href="https://secnotes.github.io/">SecNotes</a></p>
        </section>
        
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = d_id; 
        
            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        

        <footer class="post-footer">

                <section class="author">
                <p class="post-date">Published <time datetime="Sat Jul 04 2015 15:37:52 GMT+0200 (CEST)">July 4th 2015</time> <strong>by <a href="https://twitter.com/MisterCh0c">MisterCh0c</a></strong></p>
                </section>

            <section class="share">
                <h4>Share this</h4>
                <a class="icon-twitter" href="http://twitter.com/share?text=Infosec%20Institute%20CTF%20writeup%20lvl%207%20-%2013&amp;url=http://localhost:2368/infosec-institute-ctf-writeup-lvl-6-13/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:2368/infosec-institute-ctf-writeup-lvl-6-13/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://localhost:2368/infosec-institute-ctf-writeup-lvl-6-13/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

        </footer>


    </article>

</main>

    <footer class="site-footer">
    <a class="subscribe icon-feed" href="../rss/index.rss"><span class="tooltip">Subscribe!</span></a>
        <div class="inner">
             <section class="copyright">All content copyright <a href="../">MisterCh0c</a> © 2015 • All rights reserved.</section>
             <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://ghost.org">Ghost</a> in <a href="https://github.com/mityalebedev/The-Shell">The Shell</a> theme.</section>
        </div>
    </footer>

    <script src="../public/jquery.js?v=3fb1664a48"></script>
    
    <script type="text/javascript" src="../assets/highlighter/prettify.js"></script>
    <script type="text/javascript" src="../assets/js/shell.js"></script>
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Gruppo">
</body>
