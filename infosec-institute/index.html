
<head>

    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <script>
        // UNCOMMENT AND USE YOUR VARIABLES FOR DISQUS AND GOOGLE ANALYTICS
        // var d_id  = '',
        g_id  = 'UA-43267317-1', 
        g_url = 'misterch0c.ghost.io' 

    </script>
    
    <title>Infosec Institute CTF writeup lvl 1- 6</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/highlighter/prettify.css?v=70134ecdfb">
    <link rel="stylesheet" type="text/css" href="../assets/css/screen.css?v=70134ecdfb">


    <link rel="canonical" href="index.html">
    
    <meta property="og:site_name" content="MisterCh0c">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Infosec Institute CTF writeup lvl 1- 6">
    <meta property="og:description" content="Level 1 For this level we are already told that we have to exploit an XSS and pop an alert containing &quot;Ex1&quot;. So the basic payload to do that looks like this:  &amp;lt;script&amp;gt;alert('Ex1')&amp;lt;/script&amp;gt;...">
    <meta property="og:url" content="http://localhost:2368/infosec-institute/">
    <meta property="article:published_time" content="2015-07-01T23:03:37.546Z">
    <meta property="article:modified_time" content="2015-07-02T22:08:05.478Z">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Infosec Institute CTF writeup lvl 1- 6">
    <meta name="twitter:description" content="Level 1 For this level we are already told that we have to exploit an XSS and pop an alert containing &quot;Ex1&quot;. So the basic payload to do that looks like this:  &amp;lt;script&amp;gt;alert('Ex1')&amp;lt;/script&amp;gt;...">
    <meta name="twitter:url" content="http://localhost:2368/infosec-institute/">
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "MisterCh0c",
    "author": {
        "@type": "Person",
        "name": "misterch0c",
        "url": "http://localhost:2368/author/misterch0c",
        "sameAs": null,
        "description": null
    },
    "headline": "Infosec Institute CTF writeup lvl 1- 6",
    "url": "http://localhost:2368/infosec-institute/",
    "datePublished": "2015-07-01T23:03:37.546Z",
    "dateModified": "2015-07-02T22:08:05.478Z",
    "description": "Level 1 For this level we are already told that we have to exploit an XSS and pop an alert containing &quot;Ex1&quot;. So the basic payload to do that looks like this:  &amp;lt;script&amp;gt;alert(&#x27;Ex1&#x27;)&amp;lt;/script&amp;gt;..."
}
    </script>

    <meta name="generator" content="Ghost 0.6">
    <link rel="alternate" type="application/rss+xml" title="MisterCh0c" href="../rss/index.html">
    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    
      ga('create', g_id, g_url);
      ga('send', 'pageview');
    
    </script>
</head>
<body class="post-template">

    

<main class="content" role="main">

    <article class="post">

        <header class="post-header">
            <a id="blog-logo" href="../">
                    <img src="../content/images/2015/07/VSfNaIjh.jpeg" alt="Blog Logo">
            </a>
        </header>



        <h1 class="post-title">Infosec Institute CTF writeup lvl 1- 6</h1>

        <section class="post-content">
            <p><br>  </p>

<h3 id="level1">Level 1</h3>

<p>For this level we are already told that we have to exploit an XSS and pop an alert containing "Ex1". So the basic payload to do that looks like this: <br>
<code>&lt;script&gt;alert('Ex1')&lt;/script&gt;</code>
<br>We can't just post this because some validation are made on both parameters. I choose to attack the url parameter but you could attack the other one it's basically the same thing. <br>
This is the code of the url element:  </p>

<pre><code>&lt;input type="text" placeholder="Name of site" maxsize="10" class="form-control" pattern="[A Za-z]+" required="" name="name"&gt;  
</code></pre>

<p>So I removed <code>pattern="[A Za-z]</code> which makes the input only accept uppercase or lowercase characters and also changed the type value from "url" to "text".So now we can post stuff! But still no alert. I took a look at the javascript and noticed this: <br>
<code>var siteName = $(".ex1input[type='text']").val().trim().replace(/&lt;/g,"&amp;lt;").replace(/&gt;/g, "&amp;gt;");</code>
What it's doing is replacing &lt; and &gt; with their html code, which is not what we want. So there in chrome I just removed the .replace(), hit ctrl+s and voil√†</p>

<p><img src="../content/images/2015/07/2015-07-01--1435784382_999x698_scrot.png" alt=""></p>

<h2 id="level2">Level 2</h2>

<p>The page showed a calculator and we were asked to inject the PHP statement shat shows informations about Apache etc which is basicaly <code>phpinfo();</code>. I quickly noticed that the two inputs were verified. You could only enter numbers and nothing on the frontend to bypass that. That leaves us with the only other thing can we're sending: the operator. <br>
I modified the operator value like this: <br>
<code>&lt;option value=";phpinfo();"&gt;+&lt;/option&gt;</code> so basically when you send 1+1 it would translate to valid php code: <code>1;phpinfo();1;</code></p>

<h2 id="level3">Level 3</h2>

<p><img src="../content/images/2015/07/lvl3.png" alt=""></p>

<p>First thing is to create an account, then after login I could see 'role:normal' which was a hint. So the delimiter is ":" to separate key/value and I guessed that it would have a newline after that. <br>
So my idea was to insert something like <code>someName\nrole:admin</code>but I couldn't just do this in the form. The easiest way I found to do it is to change the input type to "textarea", that allows you to input a new line and <code>role:admin</code> in it. Otherwhise you can intercept the request with burpsuite for example and modify it there  </p>

<h2 id="level4">Level 4</h2>

<blockquote>
  <p>You are confronted with a website that loads some .txt files to display content for its pages. You are thinking that it may be vulnerable. You aim to load a nice file from a remote server and share the link with unsuspecting visitors.
  Your task is to successfully load a PHP file located in the root of infosecinstitute.com. The file should not exist but you must load it without getting errors and it must have the PHP file extension.</p>
</blockquote>

<p>The url looked like: <br>
<code>http://ctf.infosecinstitute.com/ctf2/exercises/ex4.php?file=file1.txt</code>
So from the instruction and the url we can deduce we can use RFI here. And if you read carrefuly the instruction (unlike me at first) you know that the root is <code>infosecinstitute.com</code> and not <code>../../</code> of course... <br>
From there we got this error message:</p>

<p><img src="../content/images/2015/07/2015-07-02--1435871992_256x49_scrot.png" alt=""></p>

<p>That's right. So somehow the website detected we entered an url. There must some regex behind that. Earlier I did a bit of fuzzing on the file attribute and noted that I got different error message if I used upper or lower case. So this is how I got the flag, bypassing the regex: <br>
<code>http://ctf.infosecinstitute.com/ctf2/exercises/ex4.php?file=hTtp://infosecinstitute.com/file2.txt.php</code></p>

<h2 id="level5">Level 5</h2>

<blockquote>
  <p>It seems you have encountered a page which requires users to login before viewing. Do some magic without having to log in.
  The login button didn't work</p>
</blockquote>

<p><img src="../content/images/2015/07/2015-07-02--1435873685_632x75_scrot.png" alt=""></p>

<p>I intercept a request with burpsuite and changed the refer to login.html which I got from the source code. It tricks the browser to think we're coming from the login page</p>

<p><img src="../content/images/2015/07/2015-07-02--1435873160_546x342_scrot.png" alt=""></p>

<h2 id="level6">Level 6</h2>

<blockquote>
  <p>It seems you have landed on a site that takes HTML tags for article's comments. You want to exploit this by making the users perform an action on the bank.php file in the root of site.com, if they are logged in there. You want users browsers to load that page and execute the query string transferTo with the number 555 as a parameter. Go ahead.</p>
</blockquote>

<p>Well this was just about reading the instructions. <br>
<code>&lt;img src="http://site.com/bank.php?transferTo=555"&gt;</code></p>
        </section>
        
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = d_id; 
        
            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        

        <footer class="post-footer">

                <section class="author">
                <p class="post-date">Published <time datetime="Thu Jul 02 2015 01:03:37 GMT+0200 (CEST)">July 2nd 2015</time> <strong>by <a href="https://twitter.com/MisterCh0c">MisterCh0c</a></strong></p>
                </section>

            <section class="share">
                <h4>Share this</h4>
                <a class="icon-twitter" href="http://twitter.com/share?text=Infosec%20Institute%20CTF%20writeup%20lvl%201-%206&amp;url=http://localhost:2368/infosec-institute/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:2368/infosec-institute/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://localhost:2368/infosec-institute/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

        </footer>


    </article>

</main>

    <footer class="site-footer">
    <a class="subscribe icon-feed" href="../rss/index.rss"><span class="tooltip">Subscribe!</span></a>
        <div class="inner">
             <section class="copyright">All content copyright <a href="../">MisterCh0c</a> ¬© 2015 ‚Ä¢ All rights reserved.</section>
             <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://ghost.org">Ghost</a> in <a href="https://github.com/mityalebedev/The-Shell">The Shell</a> theme.</section>
        </div>
    </footer>

    <script src="../public/jquery.js?v=70134ecdfb"></script>
    
    <script type="text/javascript" src="../assets/highlighter/prettify.js"></script>
    <script type="text/javascript" src="../assets/js/shell.js"></script>
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Gruppo">
</body>
